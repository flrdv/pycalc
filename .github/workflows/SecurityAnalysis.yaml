name: Security Analysis

on:
  push:
    branches: oheed
  pull_request:
    branches: oheed

jobs:
  security:
    name: Security Analysis
    runs-on: ubuntu-latest
    strategy:
      matrix:
        language: [python, java] # Add more languages as needed
    steps:
      - name: Checkout code
        uses: actions/checkout@v2
      - name: Setup CodeQL
        uses: github/codeql-action/setup@v1
        with:
          languages: ${{ matrix.language }}
      - name: Build CodeQL database
        run: |
          codeql database create codeql-db/${{ matrix.language }} \
            --language=${{ matrix.language }} \
            --source-root=. \
            --exclude=codeql-db
      - name: Analyze with CodeQL
        uses: github/codeql-action/analyze@v1
        with:
          language: ${{ matrix.language }}
          query: security-and-quality/code-scanning/ql-suites/security
          database: codeql-db/${{ matrix.language }}
      - name: Upload SARIF results
        uses: github/codeql-action/upload-sarif@v1
        with:
          sarif_file: codeql-results/${{ matrix.language }}/codeql.sarif

